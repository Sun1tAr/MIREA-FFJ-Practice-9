# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–Ω—è—Ç–∏–µ ‚Ññ9: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Spring Boot

## –í—ã–ø–æ–ª–Ω–∏–ª: –¢—É–µ–≤ –î. –≠–§–ú–û-01-25

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

REST API —Å–µ—Ä–≤–∏—Å —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ Spring Security. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É (–ª–æ–≥–∏–Ω), –∏ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π (USER, ADMIN). –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BCrypt. –ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ –±–∞–∑–µ Spring Boot 3.5.7 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, Spring Security –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π.

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- **Spring Boot 3.5.7** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Spring Web** ‚Äî –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ REST API
- **Spring Security** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- **Spring Data JPA** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PostgreSQL —á–µ—Ä–µ–∑ Hibernate
- **Spring Validation** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL** ‚Äî —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **BCrypt** ‚Äî —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (part of Spring Security)
- **Lombok** ‚Äî —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
- **Maven** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- **Java 17** ‚Äî —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–õ–µ–≥–µ–Ω–¥–∞:** üîì –û—Ç–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø ¬∑ üîí –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ¬∑ üë• USER/ADMIN ¬∑ üõ°Ô∏è –¢–æ–ª—å–∫–æ ADMIN

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –î–µ–π—Å—Ç–≤–∏–µ | –û—Ç–≤–µ—Ç | –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è | –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ |
|-------|----------|-----------|----------|-------|-----------|-------------|
| üîì **POST** | `/auth/register` | - | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | `201 CREATED` | –ù–µ—Ç | `JSON` –æ–±—ä–µ–∫—Ç UserDTO |
| üîì **POST** | `/auth/login` | - | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É | `200 OK` | –ù–µ—Ç | `JSON` –æ–±—ä–µ–∫—Ç UserDTO |

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (POST /auth/register):
```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (POST /auth/login):
```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

–û—Ç–≤–µ—Ç (POST /auth/register, POST /auth/login):
```json
{
  "id": 1,
  "email": "user@example.com"
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
my/learn/mireaffjpractice9/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ SecurityConfig.java                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Spring Security
‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îú‚îÄ‚îÄ AuthController.java                     # REST API –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –ª–æ–≥–∏–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ UserController.java                     # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ request/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserRegisterRequest.java            # DTO –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserLoginRequest.java               # DTO –¥–ª—è –ª–æ–≥–∏–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ responce/
‚îÇ       ‚îî‚îÄ‚îÄ UserDTO.java                        # DTO –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ exception/
‚îÇ   ‚îú‚îÄ‚îÄ AppException.java                       # –ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ UserAlreadyExistException.java          # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ email
‚îÇ   ‚îî‚îÄ‚îÄ handler/
‚îÇ       ‚îî‚îÄ‚îÄ MyExceptionHandler.java             # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îú‚îÄ‚îÄ User.java                               # JPA Entity –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (UserDetails)
‚îÇ   ‚îî‚îÄ‚îÄ UserRole.java                           # Enum —Ä–æ–ª–µ–π (USER, ADMIN)
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îî‚îÄ‚îÄ UserRepository.java                     # JPA —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îú‚îÄ‚îÄ UserService.java                        # Interface —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ UserServiceImpl.java                     # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å UserDetailsService
‚îú‚îÄ‚îÄ util/
‚îÇ   ‚îî‚îÄ‚îÄ UserMapper.java                         # –ú–∞–ø–ø–µ—Ä –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è User -> UserDTO
‚îî‚îÄ‚îÄ MireaFfjPractice9Application.java           # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Postman –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API. –î–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ [–∫–æ–ª–ª–µ–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤](https://lively-flare-564043.postman.co/workspace/My-Workspace~fe2081e8-b325-4776-8b48-400d41f5b4bd/collection/42992055-42a59dfd-3dd4-4116-abf5-8af583ae3615?action=share&creator=42992055).

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–∞

| –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –ì–¥–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è | –ß—Ç–æ –∑–Ω–∞—á–∏—Ç / –∫–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è |
| :-- | :-- | :-- | :-- |
| 200 | OK | `/auth/login` | –£—Å–ø–µ—à–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. |
| 201 | Created | `/auth/register` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω. |
| 400 | Bad Request | `/auth/register`, `/auth/login` | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (email –Ω–µ–≤–∞–ª–∏–¥–µ–Ω, –ø–∞—Ä–æ–ª—å –∫–æ—Ä–æ—á–µ 5 —Å–∏–º–≤–æ–ª–æ–≤). |
| 401 | Unauthorized | `/auth/login`, –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã | –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è. |
| 409 | Conflict | `/auth/register` | Email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º–µ. |
| 500 | Internal Server Error | `MyExceptionHandler` | –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. |

### –¢–µ—Å—Ç –∫–µ–π—Å—ã

| ‚Ññ | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ú–∞—Ä—à—Ä—É—Ç | –ó–∞–ø—Ä–æ—Å (–ø—Ä–∏–º–µ—Ä) | –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç |
|--|--|--|--|--|
| 1 | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | **POST /auth/register** | `{"email":"john@example.com","password":"myPass123"}` | 201 Created + JSON UserDTO |
| 2 | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –∫–æ—Ä–æ—Ç–∫–∏–º –ø–∞—Ä–æ–ª–µ–º | **POST /auth/register** | `{"email":"jane@example.com","password":"123"}` | 400 Bad Request |
| 3 | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º email | **POST /auth/register** | `{"email":"invalid-email","password":"myPass123"}` | 400 Bad Request |
| 4 | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è email | **POST /auth/register** | `{"email":"john@example.com","password":"Pass123"}` | 409 Conflict |
| 5 | –í—Ö–æ–¥ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ | **POST /auth/login** | `{"email":"john@example.com","password":"myPass123"}` | 200 OK + JSON UserDTO |
| 6 | –í—Ö–æ–¥ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º | **POST /auth/login** | `{"email":"john@example.com","password":"wrongPass"}` | 401 Unauthorized |
| 7 | –í—Ö–æ–¥ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º email | **POST /auth/login** | `{"email":"nonexistent@example.com","password":"Pass123"}` | 401 Unauthorized |

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

![img.png](about/img.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 201 Created**, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —Å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º.

#### 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –∫–æ—Ä–æ—Ç–∫–∏–º –ø–∞—Ä–æ–ª–µ–º

![img_1.png](about/img_1.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 400 Bad Request**, –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤.

#### 3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º email

![img_2.png](about/img_2.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 400 Bad Request**, email –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É.

#### 4. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è email

![img_3.png](about/img_3.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 409 Conflict**, email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω.

#### 5. –í—Ö–æ–¥ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

![img_4.png](about/img_4.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω.

#### 6. –í—Ö–æ–¥ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º

![img_5.png](about/img_5.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 401 Unauthorized**, –Ω–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### 7. –í—Ö–æ–¥ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º email

![img_6.png](about/img_6.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 401 Unauthorized**, –Ω–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.


## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------------------|----------|----------|
| POSTGRES_URL         | URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL | jdbc:postgresql://localhost:5432/practice9_db |
| POSTGRES_USERNAME    | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î | postgres |
| POSTGRES_PASSWORD    | –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î | password |

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ application.properties:**
```properties
spring.datasource.url=${POSTGRES_URL}
spring.datasource.username=${POSTGRES_USERNAME}
spring.datasource.password=${POSTGRES_PASSWORD}
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã

#### Spring Security –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

Spring Security ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:

- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (who are you?)
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (what can you do?)
- **Authentication** ‚Äî –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- **GrantedAuthority** ‚Äî –ø—Ä–∞–≤–æ/—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–º –æ–±–ª–∞–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

#### UserDetails –∏ UserDetailsService

- **UserDetails** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–Ω—ã —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å Entity –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **UserDetailsService** ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ username
- **User** –≤ –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–±–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Spring Security

#### BCrypt –∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

BCrypt ‚Äî —ç—Ç–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ö–µ—à-–∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π:

- **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è –≤ –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∏–º—É—é —Å—Ç—Ä–æ–∫—É
- **Salt** ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –¥–æ–±–∞–≤–ª—è–µ–º–æ–µ –∫ –ø–∞—Ä–æ–ª—é –ø–µ—Ä–µ–¥ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **Strength** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (12 –≤ –ø—Ä–æ–µ–∫—Ç–µ = —Å–ª–æ–∂–Ω–æ–µ –∏ –º–µ–¥–ª–µ–Ω–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî BCrypt –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π —Ö–µ—à, –Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

#### SecurityFilterChain –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

SecurityFilterChain ‚Äî —Ü–µ–ø—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ Spring Security, –∫–æ—Ç–æ—Ä–∞—è:

- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π HTTP –∑–∞–ø—Ä–æ—Å
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—É—Ç–µ–π –∏ —Ä–æ–ª–µ–π
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ —Ç–∏–ø–∞: `/public/**` ‚Äî –æ—Ç–∫—Ä—ã—Ç–æ, `/admin/**` ‚Äî —Ç–æ–ª—å–∫–æ ADMIN

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∫–æ–¥–∞

#### 1. SecurityConfig —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Ñ–∏–ª—å—Ç—Ä–æ–≤

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        return http
                .csrf(csrf -> csrf.disable())
                .authorizeHttpRequests(authz -> authz
                        .requestMatchers("/", "/auth/**").permitAll()
                        .requestMatchers("/user/**").hasAnyRole(UserRole.USER.name(), UserRole.ADMIN.name())
                        .requestMatchers("/admin/**").hasRole(UserRole.ADMIN.name())
                        .anyRequest().authenticated()
                )
                .build();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder(12);
    }

    @Bean
    public AuthenticationManager authenticationManager(AuthenticationConfiguration config) throws Exception {
        return config.getAuthenticationManager();
    }
}
```

#### 2. User Entity —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π UserDetails

```java
@Entity
@Table(name = "users")
@Data
@Builder
public class User implements UserDetails {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(unique = true, nullable = false)
    private String email;

    @Column(nullable = false)
    private String passwordHash;

    @Column
    private LocalDateTime createdAt;

    @Column
    private LocalDateTime updatedAt;

    @Override
    public Collection<? extends GrantedAuthority> getAuthorities() {
        return List.of(UserRole.USER);
    }

    @Override
    public String getPassword() {
        return passwordHash;
    }

    @Override
    public String getUsername() {
        return email;
    }
}
```

#### 3. AuthController —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ª–æ–≥–∏–Ω–æ–º

```java
@RestController
@RequestMapping("/auth")
@RequiredArgsConstructor
public class AuthController {
    private final UserService userService;
    private final AuthenticationManager authenticationManager;

    @PostMapping("/register")
    public ResponseEntity<UserDTO> registrateNewUser(@Valid @RequestBody UserRegisterRequest request) {
        User saved = userService.save(request);
        return new ResponseEntity<>(UserMapper.mapToDTO(saved), HttpStatus.CREATED);
    }

    @PostMapping("/login")
    public ResponseEntity<UserDTO> login(@Valid @RequestBody UserLoginRequest request) {
        Authentication auth = authenticationManager.authenticate(
                new UsernamePasswordAuthenticationToken(
                        request.getEmail(),
                        request.getPassword()
                )
        );
        User principal = (User) auth.getPrincipal();
        return new ResponseEntity<>(UserMapper.mapToDTO(principal), HttpStatus.OK);
    }
}
```

#### 4. UserServiceImpl —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π UserDetailsService

```java
@Service
@Transactional
@RequiredArgsConstructor
public class UserServiceImpl implements UserService {
    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    @Override
    public User save(UserRegisterRequest req) {
        Optional<User> byEmail = userRepository.findByEmail(req.getEmail());
        if (byEmail.isPresent()) {
            throw new UserAlreadyExistException("User with email " + req.getEmail() + " already exists");
        }
        User user = User.builder()
                .email(req.getEmail())
                .passwordHash(passwordEncoder.encode(req.getPassword()))
                .createdAt(LocalDateTime.now())
                .updatedAt(LocalDateTime.now())
                .build();
        return userRepository.save(user);
    }

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        return userRepository.findByEmail(username)
                .orElseThrow(() -> new UsernameNotFoundException(username));
    }
}
```

#### 5. –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```java
@ControllerAdvice
public class MyExceptionHandler {
    
    @ExceptionHandler
    public ResponseEntity<Object> handleException(AuthenticationException exception) {
        HashMap<String, Object> body = new HashMap<>();
        body.put("message", exception.getMessage());
        return new ResponseEntity<>(body, HttpStatus.UNAUTHORIZED);
    }

    @ExceptionHandler
    public ResponseEntity<Object> handleException(AppException exception) {
        HashMap<String, Object> body = new HashMap<>();
        body.put("message", exception.getMessage());
        return new ResponseEntity<>(body, exception.getStatus());
    }
}
```

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

#### 1. –ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è?

- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ (–∫—Ç–æ –≤—ã?)
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (email, –ø–∞—Ä–æ–ª—å)
  - Spring Security –∏—Ö –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ —Å–æ–∑–¥–∞—ë—Ç Authentication –æ–±—ä–µ–∫—Ç
  - –†–µ–∑—É–ª—å—Ç–∞—Ç: –ª–∏–±–æ —É—Å–ø–µ—Ö, –ª–∏–±–æ AuthenticationException

- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ (—á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –¥–µ–ª–∞—Ç—å?)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º
  - –†–µ–∑—É–ª—å—Ç–∞—Ç: 200 OK –ª–∏–±–æ 403 Forbidden

#### 2. –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω BCrypt?

BCrypt ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π:

- **–ù–µ–æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å** ‚Äî –ø–∞—Ä–æ–ª—å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–∑ —Ö–µ—à–∞
- **Salt** ‚Äî –∫–∞–∂–¥—ã–π —Ö–µ—à —É–Ω–∏–∫–∞–ª–µ–Ω –±–ª–∞–≥–æ–¥–∞—Ä—è —Ä–∞–Ω–¥–æ–º–Ω–æ–º—É salt
- **–ú–µ–¥–ª–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä strength –¥–µ–ª–∞–µ—Ç —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –º–µ–¥–ª–µ–Ω–Ω—ã–º –ø—Ä–æ—Ç–∏–≤ brute-force –∞—Ç–∞–∫
- **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî `matches(password, hash)` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø–∞—Ä–æ–ª—å —Å —Ö–µ—à–µ–º

#### 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç SecurityFilterChain?

SecurityFilterChain ‚Äî —Ü–µ–ø—å —Ñ–∏–ª—å—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å:

1. –ó–∞–ø—Ä–æ—Å –ø–æ—Å—Ç—É–ø–∞–µ—Ç –≤ —Ü–µ–ø—å —Ñ–∏–ª—å—Ç—Ä–æ–≤
2. –§–∏–ª—å—Ç—Ä—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç: —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—É—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
3. –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ Authentication –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
4. –ï—Å–ª–∏ –µ—Å—Ç—å ‚Äî –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Ä–æ–ª–∏/–ø—Ä–∞–≤–∞ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
5. –ï—Å–ª–∏ –≤—Å—ë OK ‚Äî –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É
6. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 401 (–Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω) –∏–ª–∏ 403 (–±–µ–∑ –ø—Ä–∞–≤)

#### 4. –ß—Ç–æ —Ç–∞–∫–æ–µ GrantedAuthority –∏ UserRole?

- **GrantedAuthority** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤/—Ä–æ–ª–µ–π
- **UserRole** ‚Äî enum, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π GrantedAuthority –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–µ–π (USER, ADMIN)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤: `hasRole("ADMIN")`, `hasAnyRole("USER", "ADMIN")`
- –í SecurityConfig –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞

#### 5. –ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω UserDetailsService?

UserDetailsService –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Spring Security –¥–ª—è:

- –ó–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ username (email –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ)
- –ü–æ–ª—É—á–µ–Ω–∏—è GrantedAuthority –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–æ–ª–∏)
- –†–∞–±–æ—Ç—ã —Å Custom User —Å—É—â–Ω–æ—Å—Ç—è–º–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ë–î –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

```java
public UserDetails loadUserByUsername(String username) {
    return userRepository.findByEmail(username).orElseThrow(...);
}
```

#### 6. –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –≤—ã–∑–æ–≤–µ /auth/login?

1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST —Å email –∏ password
2. AuthenticationManager —Å–æ–∑–¥–∞—ë—Ç UsernamePasswordAuthenticationToken
3. Spring Security –≤—ã–∑—ã–≤–∞–µ—Ç UserDetailsService.loadUserByUsername(email)
4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–π User —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å password —á–µ—Ä–µ–∑ BCrypt
5. –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è Authentication —Å GrantedAuthority
6. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è BadCredentialsException (401 Unauthorized)

#### 7. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç @Transactional –≤ UserServiceImpl?

@Transactional –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å** ‚Äî –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (findByEmail + save) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **–û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ** ‚Äî –µ—Å–ª–∏ –≤—ã–±—Ä–æ—Å–∏—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –ë–î –æ—Ç–∫–∞—Ç–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Lazy loading** ‚Äî —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **ACID –≥–∞—Ä–∞–Ω—Ç–∏–∏** ‚Äî —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

## –í—ã–≤–æ–¥—ã

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è ‚Ññ9 –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω REST API —Å–µ—Ä–≤–∏—Å —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –±–∞–∑–µ Spring Security. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.

**–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö
- –í–Ω–µ–¥—Ä–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ email –∏ –ø–∞—Ä–æ–ª—å
- –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BCrypt
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π (USER, ADMIN)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ SecurityFilterChain –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (401, 403)
- –ü—Ä–∏–º–µ–Ω–µ–Ω—ã DTO –¥–ª—è –æ—Ç–¥–µ–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ç API
- User Entity —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã UserDetails –∏ GrantedAuthority

**–ü—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏:**

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Spring Security –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è UserDetailsService –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö Entity
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BCrypt –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SecurityFilterChain –∏ –ø—Ä–∞–≤–∏–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π @Valid –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DTO –¥–ª—è API
- –†–∞–±–æ—Ç–∞ —Å —Ä–æ–ª—è–º–∏ –∏ GrantedAuthority

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–æ–≤, OAuth2, –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∞—É–¥–∏—Ç–∞ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç.–¥.).
